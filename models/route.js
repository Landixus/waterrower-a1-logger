var LatLon = require('geodesy').LatLonVectors;

function Route() {
    this.index = 0;
    this.coordinates = osloRow;
    this.start = osloRow[0];
}

Route.prototype.nextPoint = function (p, meters) {
    if (!p) {
        p = new LatLon(this.start.lat, this.start.lon)
    }
    var next = this.getNext(this.index);
    var coo = this.coordinates[next];
    var nextP = new LatLon(coo.lat, coo.lon);
    var bearing = p.bearingTo(nextP);
    if (p.distanceTo(nextP, 6362170) < 10) {
        this.index = next;
    }
    return p.destinationPoint(meters, bearing, 6362170);
};

Route.prototype.getIndex = function (i) {
  return i < this.coordinates.length ? i : 0 ;
};

Route.prototype.getNext = function (i) {
    return this.getIndex(i + 1);
}

//https://www.gpsies.com/
//(.*),(.*),(.*)
//{ lat: $1, lon: $2, el: $3 },
//Larger round in oslo
const osloTwo = [
    { lat: 59.88458761, lon: 10.76115131, el: 4.0 },
    { lat: 59.88493213, lon: 10.75711727, el: 1.0 },
    { lat: 59.88514745, lon: 10.75505733, el: 1.0 },
    { lat: 59.88506132, lon: 10.75196743, el: 1.0 },
    { lat: 59.88506132, lon: 10.74990749, el: 1.0 },
    { lat: 59.88506132, lon: 10.74767589, el: 1.0 },
    { lat: 59.88493213, lon: 10.74467182, el: 1.0 },
    { lat: 59.88523358, lon: 10.74252605, el: 1.0 },
    { lat: 59.88605179, lon: 10.74132442, el: 1.0 },
    { lat: 59.88618098, lon: 10.73874950, el: 1.0 },
    { lat: 59.88622404, lon: 10.73643207, el: 1.0 },
    { lat: 59.88622404, lon: 10.73445796, el: 1.0 },
    { lat: 59.88618098, lon: 10.73196887, el: 1.0 },
    { lat: 59.88669773, lon: 10.72990894, el: 1.0 },
    { lat: 59.88686998, lon: 10.72836399, el: 1.0 },
    { lat: 59.88721447, lon: 10.72690486, el: 1.0 },
    { lat: 59.88725753, lon: 10.72484493, el: 1.0 },
    { lat: 59.88717141, lon: 10.72338581, el: 1.0 },
    { lat: 59.88708529, lon: 10.72132587, el: 1.0 },
    { lat: 59.88699916, lon: 10.71918010, el: 1.0 },
    { lat: 59.88678385, lon: 10.71694850, el: 1.0 },
    { lat: 59.88643936, lon: 10.71514606, el: 1.0 },
    { lat: 59.88618098, lon: 10.71227073, el: 1.0 },
    { lat: 59.88583647, lon: 10.71055412, el: 1.0 },
    { lat: 59.88523358, lon: 10.70952415, el: 1.0 },
    { lat: 59.88411389, lon: 10.70900917, el: 1.0 },
    { lat: 59.88299417, lon: 10.70935249, el: 1.0 },
    { lat: 59.88170213, lon: 10.70883750, el: 1.0 },
    { lat: 59.87997934, lon: 10.70866584, el: 1.0 },
    { lat: 59.87911791, lon: 10.71003913, el: 1.0 },
    { lat: 59.87825646, lon: 10.71192741, el: 1.0 },
    { lat: 59.87773957, lon: 10.71484565, el: 1.0 },
    { lat: 59.87773957, lon: 10.71793556, el: 1.0 },
    { lat: 59.87808416, lon: 10.71999549, el: 1.0 },
    { lat: 59.87817031, lon: 10.72274208, el: 1.0 },
    { lat: 59.87756728, lon: 10.72428703, el: 1.0 },
    { lat: 59.87687809, lon: 10.72651863, el: 1.0 },
    { lat: 59.87575812, lon: 10.72703361, el: 1.0 },
    { lat: 59.87463811, lon: 10.72806358, el: 1.0 },
    { lat: 59.87403502, lon: 10.72960853, el: 1.0 },
    { lat: 59.87437964, lon: 10.73321342, el: 1.0 },
    { lat: 59.87472427, lon: 10.73596000, el: 1.0 },
    { lat: 59.87541351, lon: 10.73767662, el: 1.0 },
    { lat: 59.87567197, lon: 10.74042320, el: 1.0 },
    { lat: 59.87748113, lon: 10.74385643, el: 1.0 },
    { lat: 59.87885948, lon: 10.74866294, el: 1.0 },
    { lat: 59.87980706, lon: 10.75123786, el: 1.0 },
    { lat: 59.88152986, lon: 10.75518608, el: 1.0 },
    { lat: 59.88325257, lon: 10.75879096, el: 1.0 },
    { lat: 59.88394163, lon: 10.76067924, el: 1.0 },
];


// Short round in Oslo
const osloRow = [
        { lat: 59.88458761, lon: 10.76097965, el: 3.0 },
        { lat: 59.88488907, lon: 10.75823307, el: 1.0 },
        { lat: 59.88544890, lon: 10.75488567, el: 1.0 },
        { lat: 59.88536277, lon: 10.75050830, el: 1.0 },
        { lat: 59.88510439, lon: 10.74767589, el: 1.0 },
        { lat: 59.88437229, lon: 10.74467182, el: 1.0 },
        { lat: 59.88303724, lon: 10.74312686, el: 1.0 },
        { lat: 59.88230509, lon: 10.74166774, el: 1.0 },
        { lat: 59.88118530, lon: 10.74106693, el: 1.0 },
        { lat: 59.88028084, lon: 10.74063777, el: 1.0 },
        { lat: 59.87963477, lon: 10.74089527, el: 1.0 },
        { lat: 59.87864411, lon: 10.74149608, el: 1.0 },
        { lat: 59.87795494, lon: 10.74192523, el: 1.0 },
        { lat: 59.87739498, lon: 10.74252605, el: 1.0 },
        { lat: 59.87640426, lon: 10.74321269, el: 1.0 },
        { lat: 59.87554274, lon: 10.74235439, el: 1.0 },
        { lat: 59.87463811, lon: 10.74115276, el: 1.0 },
        { lat: 59.87356115, lon: 10.74072360, el: 1.0 },
        { lat: 59.87274263, lon: 10.74132442, el: 1.0 },
        { lat: 59.87231183, lon: 10.74304103, el: 1.0 },
        { lat: 59.87226874, lon: 10.74492931, el: 1.0 },
        { lat: 59.87218258, lon: 10.74681758, el: 1.0 },
        { lat: 59.87269955, lon: 10.74827671, el: 1.0 },
        { lat: 59.87356115, lon: 10.75025081, el: 1.0 },
        { lat: 59.87437964, lon: 10.75179576, el: 1.0 },
        { lat: 59.87519812, lon: 10.75265407, el: 1.0 },
        { lat: 59.87610273, lon: 10.75394153, el: 1.0 },
        { lat: 59.87743806, lon: 10.75522899, el: 1.0 },
        { lat: 59.87825646, lon: 10.75591564, el: 1.0 },
        { lat: 59.87890255, lon: 10.75703144, el: 1.0 },
        { lat: 59.88010855, lon: 10.75780391, el: 1.0 },
        { lat: 59.88105610, lon: 10.75883388, el: 1.0 },
        { lat: 59.88200361, lon: 10.75917720, el: 1.0 },
        { lat: 59.88312337, lon: 10.75969219, el: 1.0 },
        { lat: 59.88394163, lon: 10.76029300, el: 1.0 },
        { lat: 59.88428616, lon: 10.76097965, el: 1.0 }
    ];

//Ildjernet
const ildjernet = [
    { lat: 59.88463068, lon: 10.76067924, el: 2.0 },
    { lat: 59.88428616, lon: 10.75758934, el: 1.0 },
    { lat: 59.88376937, lon: 10.75415611, el: 1.0 },
    { lat: 59.88325257, lon: 10.75089454, el: 1.0 },
    { lat: 59.88299417, lon: 10.74746131, el: 1.0 },
    { lat: 59.88187441, lon: 10.74402809, el: 1.0 },
    { lat: 59.88135758, lon: 10.74110984, el: 1.0 },
    { lat: 59.88075461, lon: 10.73681831, el: 1.0 },
    { lat: 59.87989320, lon: 10.73252677, el: 1.0 },
    { lat: 59.87946248, lon: 10.72995185, el: 1.0 },
    { lat: 59.87929020, lon: 10.72720527, el: 1.0 },
    { lat: 59.87860104, lon: 10.72291374, el: 1.0 },
    { lat: 59.87773957, lon: 10.71879386, el: 1.0 },
    { lat: 59.87722268, lon: 10.71415901, el: 1.0 },
    { lat: 59.87687809, lon: 10.71038246, el: 1.0 },
    { lat: 59.87670579, lon: 10.70626258, el: 1.0 },
    { lat: 59.87644733, lon: 10.70197105, el: 1.0 },
    { lat: 59.87601658, lon: 10.69750785, el: 1.0 },
    { lat: 59.87541351, lon: 10.69321632, el: 1.0 },
    { lat: 59.87524120, lon: 10.68806648, el: 1.0 },
    { lat: 59.87506889, lon: 10.68446159, el: 1.0 },
    { lat: 59.87524120, lon: 10.68051338, el: 1.0 },
    { lat: 59.87515504, lon: 10.67587852, el: 1.0 },
    { lat: 59.87498273, lon: 10.67193031, el: 1.0 },
    { lat: 59.87455196, lon: 10.66781044, el: 1.0 },
    { lat: 59.87420733, lon: 10.66369056, el: 1.0 },
    { lat: 59.87386270, lon: 10.65922737, el: 1.0 },
    { lat: 59.87291495, lon: 10.65493583, el: 1.0 },
    { lat: 59.87153636, lon: 10.65115928, el: 1.0 },
    { lat: 59.86981304, lon: 10.64806938, el: 1.0 },
    { lat: 59.86843432, lon: 10.64635276, el: 1.0 },
    { lat: 59.86740024, lon: 10.64600944, el: 1.0 },
    { lat: 59.86593524, lon: 10.64721107, el: 1.0 },
    { lat: 59.86438400, lon: 10.64892768, el: 1.0 },
    { lat: 59.86266031, lon: 10.64927101, el: 1.0 },
    { lat: 59.86102272, lon: 10.64841270, el: 1.0 },
    { lat: 59.85921266, lon: 10.64806938, el: 1.0 },
    { lat: 59.85757490, lon: 10.64652442, el: 1.0 },
    { lat: 59.85593706, lon: 10.64635276, el: 1.0 },
    { lat: 59.85378188, lon: 10.64343452, el: 1.0 },
    { lat: 59.85266114, lon: 10.64326286, el: 1.0 },
    { lat: 59.85188521, lon: 10.64223289, el: 1.0 },
    { lat: 59.85041953, lon: 10.64103126, el: 1.0 },
    { lat: 59.84947111, lon: 10.64000129, el: 1.0 },
    { lat: 59.84826400, lon: 10.63811302, el: 1.0 },
    { lat: 59.84766042, lon: 10.63605308, el: 1.0 },
    { lat: 59.84636701, lon: 10.63382148, el: 1.0 },
    { lat: 59.84630234, lon: 10.63294172, el: 1.0 },
    { lat: 59.84589275, lon: 10.63195466, el: 1.0 },
    { lat: 59.84552627, lon: 10.63118219, el: 1.0 },
    { lat: 59.84496576, lon: 10.63092470, el: 1.0 },
    { lat: 59.84403875, lon: 10.63062429, el: 1.0 },
    { lat: 59.84326262, lon: 10.63062429, el: 1.0 },
    { lat: 59.84218464, lon: 10.63062429, el: 1.0 },
    { lat: 59.84136535, lon: 10.63049554, el: 1.0 },
    { lat: 59.84015795, lon: 10.63010931, el: 1.0 },
    { lat: 59.83981296, lon: 10.63212633, el: 1.0 },
    { lat: 59.84026575, lon: 10.63349962, el: 1.0 },
    { lat: 59.84052449, lon: 10.63590288, el: 1.0 },
    { lat: 59.84108507, lon: 10.63822031, el: 1.0 },
    { lat: 59.84222776, lon: 10.64002275, el: 1.0 },
    { lat: 59.84272364, lon: 10.64113855, el: 1.0 },
    { lat: 59.84311171, lon: 10.64182519, el: 2.0 },
    { lat: 59.84436213, lon: 10.64143896, el: 1.0 },
    { lat: 59.84528913, lon: 10.64195394, el: 1.0 },
    { lat: 59.84636701, lon: 10.64319849, el: 1.0 },
    { lat: 59.84921245, lon: 10.64412117, el: 1.0 },
    { lat: 59.85145414, lon: 10.64497947, el: 1.0 },
    { lat: 59.85343704, lon: 10.64686775, el: 1.0 },
    { lat: 59.85464397, lon: 10.64789772, el: 1.0 },
    { lat: 59.85688529, lon: 10.64841270, el: 1.0 },
    { lat: 59.85972983, lon: 10.65047264, el: 1.0 },
    { lat: 59.86171224, lon: 10.65098762, el: 1.0 },
    { lat: 59.86533199, lon: 10.65201759, el: 1.0 },
    { lat: 59.86714172, lon: 10.65201759, el: 1.0 },
    { lat: 59.87015771, lon: 10.65244674, el: 1.0 },
    { lat: 59.87334575, lon: 10.66231727, el: 1.0 },
    { lat: 59.87334575, lon: 10.67124366, el: 1.0 },
    { lat: 59.87325959, lon: 10.68017005, el: 1.0 },
    { lat: 59.87334575, lon: 10.69407463, el: 1.0 },
    { lat: 59.87403502, lon: 10.69922447, el: 1.0 },
    { lat: 59.87515504, lon: 10.70780754, el: 1.0 },
    { lat: 59.87601658, lon: 10.71536064, el: 1.0 },
    { lat: 59.87670579, lon: 10.72411537, el: 1.0 },
    { lat: 59.87808416, lon: 10.73596000, el: 1.0 },
    { lat: 59.87946248, lon: 10.74093818, el: 1.0 },
    { lat: 59.88152986, lon: 10.74763298, el: 1.0 },
    { lat: 59.88247736, lon: 10.75329780, el: 1.0 },
    { lat: 59.88351097, lon: 10.75861930, el: 1.0 },
    { lat: 59.88376937, lon: 10.76085090, el: 1.0 },
    ];
// export the class
module.exports = Route;